-- This is a template for executing OS commands through SQL Server using OLE Automation Procedures

-- Enabled advanced options
sp_configure 'Show Advanced Options',1
RECONFIGURE
GO

-- Enabled OLE
sp_configure 'Ole Automation Procedures',1
RECONFIGURE
GO

-- Execute Command via OLE
DECLARE @Shell INT
EXEC Sp_oacreate 'wscript.shell', @Shell Output, 5
EXEC Sp_oamethod @shell, 'run' , null, 'cmd.exe /c "echo Hello World > c:\temp\file.txt"'

-- Read results
DECLARE @fso INT
DECLARE @file INT
DECLARE @o INT
DECLARE @f INT
DECLARE @ret INT
DECLARE @FileContents varchar(8000)
EXEC Sp_oacreate 'scripting.filesystemobject' , @fso Output
EXEC Sp_oamethod @fso, 'opentextfile' , @file Out, 'c:\temp\file.txt',1
EXEC sp_oacreate 'scripting.filesystemobject', @o out 
EXEC sp_oamethod @o, 'opentextfile', @f out, 'c:\temp\file.txt', 1 
EXEC @ret = sp_oamethod @f, 'readall', @FileContents out

SELECT @FileContents
